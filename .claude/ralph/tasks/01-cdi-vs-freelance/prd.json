{
  "branchName": "feat/01-cdi-vs-freelance",
  "userStories": [
    {
      "id": "US-001",
      "title": "Initialiser le projet Next.js avec TypeScript et Tailwind CSS",
      "acceptanceCriteria": [
        "Projet Next.js 14+ créé avec App Router dans /Users/mickaelbourgois/projet/apps/cdivsfreelance",
        "TypeScript configuré (tsconfig.json présent)",
        "Tailwind CSS configuré (tailwind.config.ts et globals.css)",
        "Dossier src/ avec structure app/ et components/ et lib/ et types/",
        "Page src/app/page.tsx avec placeholder simple (h1 'CDI vs Freelance')",
        "Layout src/app/layout.tsx avec métadonnées de base",
        "npm run build passe sans erreurs",
        "npm run dev démarre sans erreurs"
      ],
      "priority": 1,
      "passes": true,
      "notes": "Créé via npx create-next-app dans /tmp puis rsync vers le répertoire projet (pour éviter le conflit .claude/). Dossiers src/components/, src/lib/, src/types/ créés manuellement. page.tsx remplacé par un h1 simple. build OK."
    },
    {
      "id": "US-002",
      "title": "Créer les types TypeScript et la bibliothèque de calculs",
      "acceptanceCriteria": [
        "Fichier src/types/index.ts créé avec interfaces CdiInputs, FreelanceInputs, CdiResults, FreelanceResults, ComparisonResults",
        "Fichier src/lib/calculations.ts créé avec fonctions calculateCdi() et calculateFreelance() et calculateComparison()",
        "calculateCdi(brutAnnuel, tauxChargesSalariales): retourne netAnnuel, netMensuel, coutEmployeurAnnuel, tjmEquivalent",
        "calculateFreelance(tjm, joursAnnuel): retourne caAnnuel, cotisations, netAnnuel, netMensuel",
        "calculateComparison(cdiResults, freelanceResults): retourne winner, ecartAnnuel, ecartPourcentage, tjmBreakEven, brutCdiBreakEven",
        "Charges salariales CDI cadre = 25%, non-cadre = 22%, personnalisé = taux fourni",
        "Charges patronales CDI = 42% du brut (coût employeur = brut * 1.42)",
        "Cotisations AE = 22% du CA",
        "TJM équivalent CDI = coutEmployeur / joursAnnuel",
        "TJM break-even = netCDI / (joursAnnuel * 0.78)",
        "Brut CDI break-even = netAE / (1 - tauxChargesSalariales)",
        "TypeScript compile sans erreurs (npx tsc --noEmit)"
      ],
      "priority": 2,
      "passes": true,
      "notes": "Fonctions pures, pas d'état React. Valeurs par défaut: tauxChargesSalariales = 0.22, joursAnnuel = 218. Formules: netAnnuel = brutAnnuel * (1 - tauxCharges), coutEmployeur = brutAnnuel * 1.42, netMensuel = netAnnuel / 12, caAnnuel = tjm * jours, cotisations = caAnnuel * 0.22, netAE = caAnnuel * 0.78. calculateComparison prend aussi cdiInputs et freelanceInputs pour accéder aux taux. npx tsc --noEmit passe sans erreurs."
    },
    {
      "id": "US-003",
      "title": "Créer le formulaire CDI",
      "acceptanceCriteria": [
        "Composant src/components/CdiForm.tsx créé",
        "Input numérique pour salaire brut annuel (€) avec placeholder '60 000'",
        "Select pour statut : 'Cadre (25%)', 'Non-cadre (22%)', 'Personnalisé'",
        "Si 'Personnalisé' sélectionné : input numérique pour le taux de charges (%) apparaît",
        "Le composant expose les props: onChange(inputs: CdiInputs) => void, values?: CdiInputs",
        "Labels clairs en français, formatage visuel des nombres avec séparateurs",
        "TypeScript compile sans erreurs"
      ],
      "priority": 3,
      "passes": true,
      "notes": "Composant contrôlé (controlled component). Props: { onChange: (inputs: CdiInputs) => void, values?: CdiInputs }. Utiliser les types de src/types/index.ts. Style Tailwind basique pour ce ticket (le polish viendra dans US-010). Input numérique pour brut annuel avec placeholder '60 000', select statut (cadre/non-cadre/personnalisé), champ taux conditionnel si personnalisé. npx tsc --noEmit passe sans erreurs."
    },
    {
      "id": "US-004",
      "title": "Créer le formulaire Freelance Auto-Entrepreneur",
      "acceptanceCriteria": [
        "Composant src/components/FreelanceForm.tsx créé",
        "Input numérique pour TJM (€/jour) avec placeholder '450'",
        "Input numérique pour jours travaillés/an avec valeur par défaut 218",
        "Texte d'aide sous le champ jours: '218 jours = standard convention collective française (52 sem. - 5 sem. congés - 11 jours fériés)'",
        "Le composant expose les props: onChange(inputs: FreelanceInputs) => void, values?: FreelanceInputs",
        "Labels clairs en français",
        "TypeScript compile sans erreurs"
      ],
      "priority": 4,
      "passes": true,
      "notes": "Composant contrôlé. Props: { onChange: (inputs: FreelanceInputs) => void, values?: FreelanceInputs }. Input TJM vide si 0 (placeholder '450'), input jours avec valeur par défaut 218. Texte d'aide sous le champ jours. npx tsc --noEmit passe sans erreurs."
    },
    {
      "id": "US-005",
      "title": "Créer la carte de résultats CDI",
      "acceptanceCriteria": [
        "Composant src/components/CdiResultCard.tsx créé",
        "Affiche : Revenu net annuel (€), Revenu net mensuel (€), Coût total employeur/an (€), TJM équivalent mission (€/j)",
        "Affiche le taux de charges appliqué (ex: '25% cadre')",
        "Formatage français des montants (ex: '46 800 €')",
        "Affiche 'Saisissez un salaire brut' si brutAnnuel = 0",
        "Props: { results: CdiResults | null, inputs: CdiInputs }",
        "TypeScript compile sans erreurs"
      ],
      "priority": 5,
      "passes": true,
      "notes": "Composant CdiResultCard créé. Affiche état vide si brutAnnuel === 0. Formatage Intl.NumberFormat fr-FR. tauxLabel calculé depuis inputs.statut + tauxChargesApplique. npx tsc --noEmit passe sans erreurs."
    },
    {
      "id": "US-006",
      "title": "Créer la carte de résultats Freelance AE",
      "acceptanceCriteria": [
        "Composant src/components/FreelanceResultCard.tsx créé",
        "Affiche : CA annuel brut (€), Cotisations sociales (€ et %), Revenu net annuel (€), Revenu net mensuel (€)",
        "Affiche le nombre de jours travaillés",
        "Formatage français des montants",
        "Affiche 'Saisissez un TJM' si tjm = 0",
        "Props: { results: FreelanceResults | null, inputs: FreelanceInputs }",
        "TypeScript compile sans erreurs"
      ],
      "priority": 6,
      "passes": true,
      "notes": "Composant FreelanceResultCard créé. Affiche état vide si tjm === 0. Formatage Intl.NumberFormat fr-FR. cotisationsPct calculé depuis results.cotisations / results.caAnnuel. Jours travaillés affiché depuis inputs.joursAnnuel. npx tsc --noEmit passe sans erreurs."
    },
    {
      "id": "US-007",
      "title": "Créer le panneau de comparaison",
      "acceptanceCriteria": [
        "Composant src/components/ComparisonPanel.tsx créé",
        "Affiche le verdict : 'Le CDI est plus avantageux' ou 'Le Freelance est plus avantageux' ou 'Équivalent'",
        "Affiche l'écart annuel en euros (ex: '+12 400 €/an pour le Freelance')",
        "Affiche l'écart en pourcentage",
        "Affiche le TJM break-even (ex: 'Pour égaler le CDI, il faut un TJM de 385 €/j')",
        "Affiche le brut CDI break-even (ex: 'Ce TJM équivaut à un brut CDI de 56 000 €')",
        "Affiche 'Remplissez les deux côtés pour comparer' si un côté est vide",
        "Props: { comparison: ComparisonResults | null }",
        "TypeScript compile sans erreurs"
      ],
      "priority": 7,
      "passes": true,
      "notes": "Composant ComparisonPanel créé. Affiche état vide si comparison === null. Verdict en grand texte coloré (bleu CDI, indigo Freelance). Écart annuel et pourcentage affichés. TJM break-even et brut CDI break-even en section séparée. npx tsc --noEmit passe sans erreurs."
    },
    {
      "id": "US-008",
      "title": "Assembler la page principale avec layout responsive",
      "acceptanceCriteria": [
        "Page src/app/page.tsx mise à jour avec tous les composants assemblés",
        "Layout desktop : 2 colonnes côte à côte (CDI à gauche, Freelance à droite)",
        "Layout mobile : colonnes empilées verticalement",
        "En-tête avec titre 'CDI vs Freelance' et sous-titre explicatif",
        "Panneau de comparaison centré sous les deux colonnes",
        "Calculs recalculés en temps réel à chaque modification des inputs",
        "État géré dans la page (useState pour inputs CDI et Freelance)",
        "Les calculs ne s'affichent que si les inputs sont valides (> 0)",
        "npm run build passe sans erreurs",
        "TypeScript compile sans erreurs"
      ],
      "priority": 8,
      "passes": true,
      "notes": "'use client' en haut de page.tsx. useState pour cdiInputs (défaut: brutAnnuel=0, statut='cadre') et freelanceInputs (défaut: tjm=0, joursAnnuel=218). cdiResults et freelanceResults calculés en temps réel avec null si inputs invalides (> 0). comparison null si l'un des deux est null. Grid md:grid-cols-2 gap-8, colonnes empilées sur mobile. Header avec titre et sous-titre. ComparisonPanel centré sous les colonnes. npx tsc --noEmit et npm run build passent sans erreurs."
    },
    {
      "id": "US-009",
      "title": "Ajouter le partage par URL",
      "acceptanceCriteria": [
        "Les inputs sont sérialisés dans les query params URL: ?brut=60000&statut=cadre&taux=25&tjm=450&jours=218",
        "Au chargement de la page, les params URL pré-remplissent les formulaires",
        "Bouton 'Copier le lien' visible dans le panneau de comparaison ou l'en-tête",
        "Un clic sur le bouton copie l'URL courante dans le presse-papier",
        "Feedback visuel après copie (texte change en 'Lien copié !' pendant 2 secondes)",
        "Les params URL se mettent à jour automatiquement quand l'utilisateur modifie les inputs (sans rechargement de page)",
        "TypeScript compile sans erreurs"
      ],
      "priority": 9,
      "passes": true,
      "notes": "Logique extraite dans src/components/HomeContent.tsx ('use client') enveloppé dans <Suspense> depuis page.tsx. useSearchParams() lit les params au montage pour pré-remplir les états. useRouter().replace() mis à jour à chaque changement d'input sans rechargement. Bouton 'Copier le lien' dans l'en-tête avec feedback 'Lien copié !' pendant 2s. Params omis si valeur par défaut (jours=218, brut=0, tjm=0). npx tsc --noEmit et npm run build passent sans erreurs."
    },
    {
      "id": "US-010",
      "title": "Design polish : couleurs, animations, tooltips et footer",
      "acceptanceCriteria": [
        "Colonne CDI visuellement distincte avec accent bleu (#3B82F6 ou similaire)",
        "Colonne Freelance visuellement distincte avec accent violet/indigo (#6366F1 ou similaire)",
        "Le gagnant dans le panneau de comparaison est mis en évidence (badge, bordure colorée, ou icône trophée)",
        "Tooltips (icône ?) présents pour : TJM équivalent mission, Coût employeur, Cotisations AE 22%, TJM break-even",
        "Footer avec disclaimer : 'Estimations indicatives. Consultez un expert-comptable pour des calculs précis.'",
        "Transitions douces sur les valeurs qui changent (ou au minimum absence de flicker)",
        "Design responsive vérifié sur mobile (375px) et desktop (1280px)",
        "npm run build passe sans erreurs"
      ],
      "priority": 10,
      "passes": true,
      "notes": "Composant Tooltip.tsx créé (group/hover Tailwind, flèche CSS, z-10). CdiResultCard: bandeau bleu en header, état vide blue-50/blue-100, tooltips sur TJM équivalent et coût employeur. FreelanceResultCard: bandeau indigo, état vide indigo-50/indigo-100, tooltip sur cotisations AE. ComparisonPanel: badge gagnant avec trophée, break-even dans 2 cartes colorées (blue/indigo), tooltips sur TJM break-even et brut CDI équivalent. HomeContent: colonnes avec titres colorés (bullet + label), formulaires dans cartes bordées (blue/indigo), footer avec disclaimer et mention expert-comptable. Icône SVG lien dans bouton Copier. tabular-nums pour les montants (pas de flicker). npx tsc --noEmit et npm run build passent sans erreurs."
    }
  ]
}
